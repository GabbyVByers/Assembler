
	LDI r0 #1
	STR r0 &rng

label MAIN_LOOP
	
	JSR .HASH_RNG
	LDR r0 &rng
	LDI r1 #255
	AND r0 r1
	STR r0 &x

	JSR .HASH_RNG
	LDR r0 &rng
	LDI r1 #255
	AND r0 r1
	STR r0 &y

	LDI r0 #2
	LDR r2 &x
	LDR r3 &y
	DRW

	JMP .MAIN_LOOP

// good-enough hashing algorithm found by trial and error
// loops after missing about half of all values
label HASH_RNG
	LDR r0 &rng
	LDI r1 #15
	JSR .MULTIPLICATION_SUBROUTINE
	ADI r0 #19
	MOV r1 r0
	SHR r1
	SHR r1
	SHL r0
	SHL r0
	XOR r0 r1
	MOV r1 r0
	SHR r1
	SHR r1
	SHL r0
	SHL r0
	XOR r0 r1
	MOV r1 r0
	SHR r1
	SHR r1
	SHL r0
	SHL r0
	XOR r0 r1
	MOV r1 r0
	SHR r1
	SHR r1
	SHL r0
	SHL r0
	XOR r0 r1
	STR r0 &rng
	RTS


label MULTIPLICATION_SUBROUTINE
	MOV r2 r0
	LDI r0 #0
	CMP r1 r2
	MOV r3 r1 FLAG_LESS_THAN
	MOV r1 r2 FLAG_LESS_THAN
	MOV r2 r3 FLAG_LESS_THAN
label MULTIPLICATION_LOOP
	CMP r2 r2
	RTS FLAG_ZERO
	ADD r0 r1
	ADI r2 #65535
	JMP .MULTIPLICATION_LOOP

	var rng
	var x
	var y


